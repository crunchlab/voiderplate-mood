(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4438],{2027:(A,M,_)=>{var m=_(4494),i=_(7839),e={};function d(n,r,u){for(var l=new m(r,u,d),t=0;t<n.length&&!f(n[t],l);t++);if(f(null,l),l.currentItem instanceof Object)l.addReference(l.currentItem);else{var o=function(n){for(var r=0;r<n.length;r++)if(!(n[r+1]&&n[r+1].value instanceof Object))return n[r].value}(l.currentParents);o&&l.addReference(o)}return{value:l.currentItem,key:l.currentKey,references:l.currentReferences,parents:l.currentParents}}function f(n,r){if(null==n)!r.currentItem&&r.options.force&&r.force(r.options.force);else if(n.values)if(r.currentItem){var u=Object.keys(r.currentItem),l=[];u.forEach(function(g){n.deep&&Array.isArray(r.currentItem[g])?r.currentItem[g].forEach(function(x){l.push(x)}):l.push(r.currentItem[g])}),r.setCurrent(u,l)}else r.setCurrent(u,[]);else if(n.get){var t=r.getValue(n.get);!function(n,r){return n.override&&n.currentItem===n.rootContext&&void 0!==n.override[r]}(r,t)?r.currentItem||r.options.force&&r.force({})?function(n,r){return n instanceof Array&&parseInt(r)!=r}(r.currentItem,t)||n.multiple?(l=r.currentItem.map(function(x){return x[t]}).filter(O),l=Array.prototype.concat.apply([],l),r.setCurrent(t,l)):r.setCurrent(t,r.currentItem[t]):r.setCurrent(t,null):r.setCurrent(t,r.override[t])}else if(n.select)if(Array.isArray(r.currentItem)||r.options.force&&r.force([])){var o=(n.boolean?n.select:[n]).map(function(g){if(":"===g.op){var x=r.getValue(g.select[0]);return{func:function(T){return x&&(T=T[x]),r.getValueFrom(g.select[1],T)},negate:g.negate,booleanOp:g.booleanOp}}var F=r.getValues(g.select);if(!r.options.allowRegexp&&"~"===g.op&&F[1]instanceof RegExp)throw new Error("options.allowRegexp is not enabled.");return{key:F[0],value:F[1],negate:g.negate,booleanOp:g.booleanOp,op:g.op}});if(n.multiple){u=[];var P=[];r.currentItem.forEach(function(x,F){a(x,o)&&(u.push(F),P.push(x))}),r.setCurrent(u,P)}else r.currentItem.some(function(g,x){if(a(g,o))return r.setCurrent(x,g),!0})||r.setCurrent(null,null)}else r.setCurrent(null,null);else if(n.root)r.resetCurrent(),r.setCurrent(null,n.args&&n.args.length?r.getValue(n.args[0]):r.rootContext);else if(n.parent)r.resetCurrent(),r.setCurrent(null,r.options.parent);else if(n.or){if(r.currentItem)return!0;r.resetCurrent(),r.setCurrent(null,r.context)}else if(n.filter){var s=r.getLocal(n.filter)||r.getGlobal(n.filter);if("function"==typeof s){l=r.getValues(n.args||[]);var h=s.apply(r.options,[r.currentItem].concat(l));r.setCurrent(null,h)}else{var p=r.getFilter(n.filter);"function"==typeof p&&(l=r.getValues(n.args||[]),h=p.call(r.options,r.currentItem,{args:l,state:r,data:r.rootContext}),r.setCurrent(null,h))}}else if(n.deep)if(r.currentItem){if(0===n.deep.length)return;if(h=r.deepQuery(r.currentItem,n.deep,r.options)){r.setCurrent(h.key,h.value);for(var C=0;C<h.parents.length;C++)r.currentParents.push(h.parents[C])}else r.setCurrent(null,null)}else r.currentItem=null}function a(n,r){for(var u=!1,l=0;l<r.length;l++){var t=r[l],o=!1;t.func?o=t.func(n):"~"===t.op?o=t.value instanceof RegExp?n[t.key]&&!!n[t.key].match(t.value):n[t.key]&&!!~n[t.key].indexOf(t.value):"="===t.op?o=!0===n[t.key]&&"true"===t.value||!1===n[t.key]&&"false"===t.value||n[t.key]==t.value:">"===t.op?o=n[t.key]>t.value:"<"===t.op?o=n[t.key]<t.value:">="===t.op?o=n[t.key]>=t.value:"<="===t.op&&(o=n[t.key]<=t.value),t.negate&&(o=!o),u="&"===t.booleanOp?u&&o:"|"===t.booleanOp&&u||o}return u}function O(n){return void 0!==n}A.exports=function(r,u){var l=u&&u.params||null;return Array.isArray(r)&&(l=r.slice(1),r=r[0]),e[r]||(e[r]=i(r,!0)),d(e[r],u,l)},A.exports.lastParent=function(n){var r=n.parents[n.parents.length-1];return r?r.value:null}},239:A=>{A.exports=function(_,m,i){var e=i&&i.max||1/0,d=i&&i.includeDelimiters||!1,f=0,a=0,O=[],v=[];_.replace(/([\[\(\{])|([\]\)\}])/g,function(r,u,l,t){u?(0===f&&v.push([a,t]),f+=1):l&&0==(f-=1)&&(a=t+r.length)}),0===f&&a<_.length&&v.push([a,_.length]),a=0;for(var y=0;y<v.length&&e>0;y++)for(var c=v[y][0],n=m.exec(_.slice(c,v[y][1]));n&&e>1;a=c+=n.index+n[0].length,n=m.exec(_.slice(c,v[y][1])))O.push(_.slice(a,n.index+c)),d&&O.push(n[0]),e-=1;return a<_.length&&O.push(_.slice(a)),O}},4494:A=>{function M(i,e,d){i=i||{},this.handleQuery=d,this.options=i,this.locals=this.options.locals||{},this.globals=this.options.globals||{},this.rootContext=_(i.data,i.rootContext,i.context,i.source),this.parent=i.parent,this.override=i.override,this.filters=i.filters||{},this.params=e||i.params||[],this.context=_(i.currentItem,i.context,i.source),this.currentItem=_(this.context,i.rootContext,i.data),this.currentKey=null,this.currentReferences=[],this.currentParents=[]}function _(i){for(var e=0;e<arguments.length;e++)if(null!=arguments[e])return arguments[e]}function m(i){var e={};if(i)for(var d in i)d in i&&(e[d]=i[d]);return e}A.exports=M,M.prototype={setCurrent:function(i,e){(this.currentItem||this.currentKey||this.currentParents.length>0)&&this.currentParents.push({key:this.currentKey,value:this.currentItem}),this.currentItem=e,this.currentKey=i},resetCurrent:function(){this.currentItem=null,this.currentKey=null,this.currentParents=[]},force:function(i){var e=this.currentParents[this.currentParents.length-1];return!this.currentItem&&e&&null!=this.currentKey&&(this.currentItem=i||{},e.value[this.currentKey]=this.currentItem),!!this.currentItem},getLocal:function(i){if(~i.indexOf("/")){for(var e=null,d=i.split("/"),f=0;f<d.length;f++){var a=d[f];0==f?e=this.locals[a]:e&&e[a]&&(e=e[a])}return e}return this.locals[i]},getGlobal:function(i){if(~i.indexOf("/")){for(var e=null,d=i.split("/"),f=0;f<d.length;f++){var a=d[f];0==f?e=this.globals[a]:e&&e[a]&&(e=e[a])}return e}return this.globals[i]},getFilter:function(i){if(~i.indexOf("/")){for(var e=null,d=i.split("/"),f=0;f<d.length;f++){var a=d[f];0==f?e=this.filters[a]:e&&e[a]&&(e=e[a])}return e}return this.filters[i]},addReferences:function(i){i&&i.forEach(this.addReference,this)},addReference:function(i){i instanceof Object&&!~this.currentReferences.indexOf(i)&&this.currentReferences.push(i)},getValues:function(i,e){return i.map(this.getValue,this)},getValue:function(i){return this.getValueFrom(i,null)},getValueFrom:function(i,e){if(null!=i._param)return this.params[i._param];if(i._sub){var d=m(this.options);d.force=null,d.currentItem=e;var f=this.handleQuery(i._sub,d,this.params);return this.addReferences(f.references),f.value}return i},deepQuery:function(i,e,d,f){for(var O in Object.keys(i),i)if(O in i){(d=m(this.options)).currentItem=i[O];var v=this.handleQuery(e,d,this.params);if(v.value)return v}return null}}},7839:(A,M,_)=>{var m=_(239);function d(c){var n=m(c,/(!)?(=|~|\:|<=|>=|<|>)/,{max:2,includeDelimiters:!0});if(3===n.length){var r="!"===n[1].charAt(0),u=a(n[0].trim()),l={negate:r,op:r?n[1].slice(1):n[1]};if(":"===l.op)l.select=[u,{_sub:A.exports(":"+n[2].trim())}];else if("~"===l.op){var t=a(n[2].trim());if("string"==typeof t){var o=n[2].trim().match(/^\/(.*)\/([a-z]?)$/);l.select=o?[u,new RegExp(o[1],o[2])]:[u,t]}else l.select=[u,t]}else l.select=[u,a(n[2].trim())];return l}}function a(c){if(function(c){return"{"===c.charAt(0)&&"}"===c.charAt(c.length-1)}(c)){var n=c.slice(1,-1);return{_sub:A.exports(n)}}return function(c){if("?"===c.charAt(0)){var n=parseInt(c.slice(1));return isNaN(n)?c:{_param:n}}return c}(c)}A.exports=function(c,n){if(!c)return[];var l,r=[],t=c.charAt(0),o=0,P=0,s=0,h=0,p=0,C="get",g=null;n&&(c=function(c){var n=0;return c.replace(/\?/g,function(r){return r+n++})}(c));var x={".":{mode:"get"},":":{mode:"filter"},"|":{handle:"or"},"[":{open:"select"},"]":{close:"select"},"{":{open:"meta"},"}":{close:"meta"},"(":{open:"args"},")":{close:"args"}};function F(I){g?g.push(I):r.push(I)}var T={get:function(I){var b="string"==typeof I?I.trim():null;b&&F({get:b})},select:function(I){if(I)F(function(c){if("*"===c)return{values:!0};if("**"===c)return{values:!0,deep:!0};var n=!1;"*"===c.charAt(0)&&(n=!0,c=c.slice(1));var r=m(c,/&|\|/,{includeDelimiters:!0});if(r.length>1){for(var u=[d(r[0].trim())],l=1;l<r.length;l+=2){var t=d(r[l+1].trim());t&&(t.booleanOp=r[l],u.push(t))}return{multiple:n,boolean:!0,select:u}}return(u=d(c.trim()))?(n&&(u.multiple=!0),u):{get:a(c.trim())}}(I));else{var b={deep:[]};r.push(b),g=b.deep}},filter:function(I){I&&F({filter:I.trim()})},or:function(){g=null,r.push({or:!0}),s=S+1},args:function(I){var b=function(c){return","===c?[","]:m(c,/,/).map(function(n){return a(n.trim())})}(I);r[r.length-1].args=b}};function Z(){var I=c.slice(o,P);T[C]&&T[C](I),C="get",o=P+1}for(var S=0;S<c.length;S++){l=t,t=c.charAt(S+1),0==(h=S-s)&&":"!==l&&"."!==l&&r.push({root:!0}),0===h&&"."===l&&"."===t&&r.push({parent:!0});var E=x[l];E&&(0===p&&(E.mode||E.open)&&(Z(),C=E.mode||E.open),0===p&&E.handle&&(Z(),T[E.handle]()),E.open?p+=1:E.close&&(p-=1),0===p&&E.close&&Z()),P=S+1}return Z(),r}},4438:(A,M,_)=>{"use strict";_.d(M,{a:()=>t});var m=_(3132),e=_(865),d=_(5415),f=_(7092),a=_(3375),O=_(5924),v=_(6019);function y(o,P){if(1&o){const s=e.EpF();e.TgZ(0,"ion-header"),e.TgZ(1,"ion-toolbar"),e.TgZ(2,"ion-buttons",1),e.TgZ(3,"ion-button",2),e.NdJ("click",function(){return e.CHM(s),e.oxw().closeModal()}),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"ion-title"),e.TgZ(6,"h4"),e._uU(7),e.qZA(),e.qZA(),e.TgZ(8,"ion-buttons",3),e.TgZ(9,"ion-button",2),e.NdJ("click",function(){return e.CHM(s),e.oxw().applyFilter()}),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const s=P.$implicit;e.xp6(4),e.Oqu(s("cancel")),e.xp6(3),e.Oqu(s("advanced-search")),e.xp6(3),e.Oqu(s("apply"))}}function c(o,P){1&o&&e._UZ(0,"ion-icon",13)}const n=function(o){return{chip_selected:o}};function r(o,P){if(1&o){const s=e.EpF();e.TgZ(0,"ion-chip",11),e.NdJ("click",function(){const C=e.CHM(s).$implicit,g=e.oxw().$implicit;return e.oxw(2).onChipClick(g,C)}),e.YNc(1,c,1,0,"ion-icon",12),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e.qZA()}if(2&o){const s=P.$implicit,h=e.oxw().$implicit,p=e.oxw().$implicit,C=e.oxw();e.Q6J("ngClass",e.VKq(5,n,C.isFilterSet(h,s))),e.uIk("data-filterPropertyValue",s.replaceAll(" ","_").replaceAll("'",""))("data-filterPropertyName",h.property.replaceAll(" ","_").replaceAll("'","")),e.xp6(1),e.Q6J("ngIf","tipologia"==h.property),e.xp6(2),e.Oqu(p(s||"NA"))}}function u(o,P){if(1&o&&(e.TgZ(0,"ion-accordion",6),e.TgZ(1,"ion-item",7),e.TgZ(2,"ion-label",8),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",9),e.YNc(5,r,4,7,"ion-chip",10),e.qZA(),e.qZA()),2&o){const s=P.$implicit,h=e.oxw().$implicit;e.Q6J("value",s),e.xp6(3),e.Oqu(h(s.property)),e.xp6(2),e.Q6J("ngForOf",s.value)}}function l(o,P){if(1&o&&(e.TgZ(0,"ion-content"),e.TgZ(1,"ion-accordion-group",4),e.YNc(2,u,6,3,"ion-accordion",5),e.qZA(),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("multiple",!0)("value",s.filters),e.xp6(1),e.Q6J("ngForOf",s.filters)}}let t=(()=>{class o{constructor(s,h,p){this.filterService=s,this.meterService=h,this.modalController=p,this.filters=[],this.selectedFilters=[],this.filters=this.meterService.getFilterValues(),this.selectedFilters=this.filterService.getFilters(),console.log("constructor",this.filterService.getFilters())}ngOnInit(){console.dir("ngOnInit",this.filterService.getFilters())}onChipClick(s,h){let p=this.getFilterByProperty(s);p?p.value.includes(h)?((0,m.remove)(p.value,C=>C===h),(0,m.remove)(this.selectedFilters,C=>!C.value.length)):p.value.push(h):(p={property:s.property,operator:s.operator,value:[h]},this.selectedFilters.push(p)),console.log(this.filterService.getFilters())}getFilterByProperty(s){return this.selectedFilters.find(h=>h.property==s.property)}getFilterByValue(s,h){return this.selectedFilters.find(p=>p.property==s.property&&p.value.includes(h))}isFilterSet(s,h){return!(0,m.isNil)(this.getFilterByValue(s,h))}applyFilter(){console.log(this.selectedFilters),this.modalController.dismiss({filters:this.selectedFilters})}closeModal(){this.modalController.dismiss()}}return o.\u0275fac=function(s){return new(s||o)(e.Y36(d.F),e.Y36(f.n),e.Y36(a.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-advanced-search"]],decls:2,vars:0,consts:[[4,"transloco"],["slot","start"],["color","light","fill","solid",3,"click"],["slot","end"],[3,"multiple","value"],["toggleIcon","chevron-down-circle-outline",3,"value",4,"ngFor","ngForOf"],["toggleIcon","chevron-down-circle-outline",3,"value"],["slot","header"],[1,"filter_section_name"],["slot","content",1,"filter_values_container"],["mode","md","class","filter_chip",3,"ngClass","click",4,"ngFor","ngForOf"],["mode","md",1,"filter_chip",3,"ngClass","click"],["name","ellipse","color","dark",4,"ngIf"],["name","ellipse","color","dark"]],template:function(s,h){1&s&&(e.YNc(0,y,11,3,"ion-header",0),e.YNc(1,l,3,3,"ion-content",0))},directives:[O.KI,a.Gu,a.sr,a.Sm,a.YG,a.wd,a.W2,a.eh,v.sg,a.We,a.Ie,a.Q$,a.hM,v.mk,v.O5,a.gu],styles:['.filter_chip[_ngcontent-%COMP%]{width:auto;text-align:center;flex-grow:3;display:inline-table;white-space:nowrap;background-color:transparent;border-style:solid;border-width:1px;border-color:var(--ion-color-medium)}.filter_chip[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{fill:none;stroke:var(--ion-color-medium);stroke-width:1px}.filter_chip.chip_selected[_ngcontent-%COMP%]{background-color:#d0d0d0}.filter_chip.chip_selected[data-filterPropertyName=mood][_ngcontent-%COMP%]{background-color:var(--ion-color-primary-contrast)}.filter_chip[data-filterPropertyValue="1"].chip_selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{fill:var(--mood-1)}.filter_chip[data-filterPropertyValue="2"].chip_selected[_ngcontent-%COMP%]{color:var(--ion-color-dark)}.filter_chip[data-filterPropertyValue="2"].chip_selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{fill:var(--mood-2)}.filter_chip[data-filterPropertyValue="3"].chip_selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{fill:var(--mood-3)}.advanced_search[_ngcontent-%COMP%]{background-color:#fff;opacity:1;border-width:0;display:inline-table}.filter_chip[_ngcontent-%COMP%]{text-transform:lowercase;text-align:center;border-width:1px}.filter_values_container[_ngcontent-%COMP%]{margin-left:13px}.filter_section_name[_ngcontent-%COMP%]{text-transform:capitalize}ion-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], ion-title[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-align:center;margin:auto}']}),o})()},5415:(A,M,_)=>{"use strict";_.d(M,{F:()=>O});var m=_(3132),e=_(2027),d=_.n(e),f=_(5306),a=_(865);let O=(()=>{class v{constructor(){this.filters=[]}setFilters(c){this.filters=c}getFilters(){return this.filters}addFilter(c){let n=this.filters.findIndex(r=>r.property==c.property);n>-1?(0,m.set)(this.filters,`[${n}].value`,c.value):this.filters.push(c)}applyFilters(c,n){let r=[],u=[],l=`${n}[*`;return this.filters.map((t,o)=>{switch(t.operator){case f.p.eq:l+=`${t.property}=${t.value}`,l+=o<this.filters.length-1?" & ":"";break;case f.p.gte:l+=`${t.property}>${t.value}`,l+=o<this.filters.length-1?" & ":"";break;case f.p.gteq:l+=`${t.property}>=${t.value}`,l+=o<this.filters.length-1?" & ":"";break;case f.p.lte:l+=`${t.property}<${t.value}`,l+=o<this.filters.length-1?" & ":"";break;case f.p.lteq:l+=`${t.property}<=${t.value}`,l+=o<this.filters.length-1?" & ":"";break;case f.p.like:l+=`${t.property}~/.*${t.value}.*/i`,l+=o<this.filters.length-1?" & ":"";break;case f.p.in:u.push(t)}}),l+="]",r=d()(l,{data:c,allowRegexp:!0}).value,u.map(t=>{(0,m.remove)(r,o=>{let P=!t.value.includes(o[t.property]),s=!(0,m.some)(t.value,h=>o[h]);return P&&s})}),r}}return v.\u0275fac=function(c){return new(c||v)},v.\u0275prov=a.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);